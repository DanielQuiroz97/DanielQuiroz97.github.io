{
  "hash": "cf58fcf4add5d5775787c96d7af080b7",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: Using ms-mint for targeted peak integration of Mass Spec data\nauthor: Cristian Quiroz-Moreno\ndate: '2023-09-05'\nslug: [ms-mint]\ncategories:\n  - LC-MS\ntags:\n  - LC-MS\n  - ms-mint\n  - DataViz\nsubtitle: 'Using ms-mint for targeted peak integration'\ndescription: 'In this post, we will use ms-mint with the objective of integrated peak areas of identified phytochemicals present in apples'\nimage: ''\neditor_options: \n  markdown: \n    wrap: 72\n---\n\n\n\n\nGoal of this notebook\n\nThis notebook has the objective to exemplify the use of targeted\nintegration of phytochemicals that are present in untargeted\nmetabolomics data of apple fruit reported in [Bilbrey et al.\n(2022)](https://nph.onlinelibrary.wiley.com/doi/full/10.1111/nph.17693)\n\nIn this case, we are going to use only the quality control (QC) samples.\n\n## Importing python libraries\n\nImporting python libraries\n\nIn this section, we will upload the required libraries in order to\ntargeted integrate a series of phytochemicals found in apples fruits.\nThe main library for this purpose is ms-mint which allows to integrate\nions of interest. In our case, each ion of interest refers to a specific\nphytochemical. For example, chlorogenic acid with a monoisotopic mass of\n354.0950 Da. Thus, the ion in positive ionization mode will be 355.1023\nm/z, while an ion of 353.0877 m/z corresponds to negative ionization.\n\n``` python\n# ms-mint: Instance for MS spectrometry data\nfrom ms_mint.Mint import Mint\nimport pandas as pd # Data wrangling\nimport numpy as np\nimport re # Regular expressions\nimport glob # listing files\nimport seaborn as sns\nimport plotly.express as px # Interactive plots\nimport pickle # Export python object\n#from ms_mint.notebook import Mint\nmint = Mint()\n```\n\n## Selecting QCs files\n\n### Negative ionization\n\nHere, we are going to select all QC files, and we are printing the first\n5 QC files.\n\n``` python\nQC_files_neg = glob.glob(\"Data/mzML/Neg/QC*\")\nmint.ms_files = QC_files_neg\nmint.ms_files[0:5]\n\n['Data/mzML/Neg/QC_035.mzML',\n 'Data/mzML/Neg/QC_189.mzML',\n 'Data/mzML/Neg/QC_042.mzML',\n 'Data/mzML/Neg/QC_014.mzML',\n 'Data/mzML/Neg/QC_147.mzML']\n```\n\n### Target ion list\n\n``` python\ntarget_list_neg = pd.read_excel(\"Data/Tables/targets.xlsx\", sheet_name = \"target_neg\")\nmint.targets = target_list_neg\nmint.targets\n```\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nDT::datatable(target_neg)\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"datatables html-widget html-fill-item\" id=\"htmlwidget-00adbdd555de057e61e1\" style=\"width:100%;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-00adbdd555de057e61e1\">{\"x\":{\"filter\":\"none\",\"vertical\":false,\"data\":[[\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\",\"8\",\"9\",\"10\",\"11\",\"12\",\"13\",\"14\",\"15\",\"16\",\"17\",\"18\",\"19\",\"20\",\"21\",\"22\",\"23\",\"24\",\"25\"],[\"4-Hydroxybenzaldehyde\",\"3,4 dihydroxybenzoic acid\",\"3,5-dihydroxybenzoic acid\",\"Protocatechiuc acid\",\"2,4,6- Trihydroxybenzaldehyde\",\"p-Coumaric acid\",\"Quercetin\",\"Chlorogenic acid\",\"Cyanidin-3-O-rutinoside\",\"Rutin\",\"(−)-Epicatechin\",\"8-hydroxy Kaempferol\",\"phloridzin\",\"Quercitrin\",\"Kaempferol-3-glucoside\",\"quercetin-3-O-glucoside\",\"2α-Hydroxyursolic Acid\",\"Procyanidin B1\",\"Procyanidin B2\",\"Kaempferol 3-O-β-rutinoside\",\"Isorhamnetin-3-O-β-D-Rutinoside\",\"malic acid\",\"D-(+)-glucose\",\"quinic acid\",\"(+)-Catechin\"],[121.0294794,153.0193087,153.0193087,153.0193087,153.0193087,163.04004,301.0353,353.08778,594.1589,609.14608,289.07173,301.03535,435.12964,447.09326,447.09326,463.08817,471.3479,577.1351,577.1351,593.1511,623.1617,133.01422,179.056,191.05608,289.07173],[10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10],[150,112,112,112,159,163,217,2.249,2.271,166,147,210,3.2,183,3.058,169,373,2.572,2.34,2.946,2.984,30,0.319,0.34,135],[148,110,110,109,157,161,214,2.189,2.211,162,144,207,3.14,179,2.998,163,371,2.512,2.28,2.886,2.924,18,0.259,0.28,132],[154,117,116,117,163,165,221,2.309,2.331,169,151,214,3.26,186,3.118,175,376,2.632,2.4,3.006,3.044,36,0.379,0.4,140],[\"s\",\"s\",\"s\",\"s\",\"s\",\"s\",\"s\",\"min\",\"min\",\"s\",\"s\",\"s\",\"min\",\"s\",\"min\",\"s\",\"s\",\"min\",\"min\",\"min\",\"min\",\"s\",\"min\",\"min\",\"s\"],[1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th> <\\/th>\\n      <th>peak_label<\\/th>\\n      <th>mz_mean<\\/th>\\n      <th>mz_width<\\/th>\\n      <th>rt<\\/th>\\n      <th>rt_min<\\/th>\\n      <th>rt_max<\\/th>\\n      <th>rt_unit<\\/th>\\n      <th>intensity_threshold<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"columnDefs\":[{\"className\":\"dt-right\",\"targets\":[2,3,4,5,6,8]},{\"orderable\":false,\"targets\":0},{\"name\":\" \",\"targets\":0},{\"name\":\"peak_label\",\"targets\":1},{\"name\":\"mz_mean\",\"targets\":2},{\"name\":\"mz_width\",\"targets\":3},{\"name\":\"rt\",\"targets\":4},{\"name\":\"rt_min\",\"targets\":5},{\"name\":\"rt_max\",\"targets\":6},{\"name\":\"rt_unit\",\"targets\":7},{\"name\":\"intensity_threshold\",\"targets\":8}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\n### Running targeted integration\n\n``` python\nmint.run(fn = 'Results/Neg/raw_integration.csv')\n<ms_mint.Mint.Mint at 0x109083610>\nmint.plot.peak_shapes(col_wrap=3)\n```\n\n![](peaks_QC_neg.png)\n\n## Positive ionization\n\nOn the other side of the ionization polarity, for positive ionization,\nwe proceed with the same workflow; describing the QCs files first, and\nuploading the target list second.\n\n```python\n['Data/mzML/Pos/QC_035.mzML',\n 'Data/mzML/Pos/QC_189.mzML',\n 'Data/mzML/Pos/QC_014.mzML',\n 'Data/mzML/Pos/QC_147.mzML',\n 'Data/mzML/Pos/QC_203.mzML']\n```\n\n### Loading targets\n\n```python\ntargets_pos = pd.read_excel(\"Data/Tables/targets.xlsx\", sheet_name = \"target_pos\")\nmint.targets = targets_pos\nmint.targets\n```\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nDT::datatable(target_pos)\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"datatables html-widget html-fill-item\" id=\"htmlwidget-aef542731c7d1ef2ffc9\" style=\"width:100%;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-aef542731c7d1ef2ffc9\">{\"x\":{\"filter\":\"none\",\"vertical\":false,\"data\":[[\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\",\"8\",\"9\",\"10\",\"11\",\"12\",\"13\",\"14\",\"15\",\"16\",\"17\",\"18\",\"19\",\"20\",\"21\",\"22\",\"23\",\"24\",\"25\"],[\"4-Hydroxybenzaldehyde\",\"3,4 dihydroxybenzoic acid\",\"3,5-dihydroxybenzoic acid\",\"Protocatechiuc acid\",\"2,4,6- Trihydroxybenzaldehyde\",\"p-Coumaric acid\",\"Quercetin\",\"Chlorogenic acid\",\"Cyanidin-3-O-rutinoside\",\"Rutin\",\"(−)-Epicatechin\",\"8-hydroxy Kaempferol\",\"phloridzin\",\"Quercitrin\",\"Kaempferol-3-glucoside\",\"quercetin-3-O-glucoside\",\"2α-Hydroxyursolic Acid\",\"Procyanidin B1\",\"Procyanidin B2\",\"Kaempferol 3-O-β-rutinoside\",\"Isorhamnetin-3-O-β-D-Rutinoside\",\"malic acid\",\"D-(+)-glucose\",\"quinic acid\",\"(+)-Catechin\"],[121.0294794,153.0193087,153.0193087,153.0193087,153.0193087,163.04004,301.0353,353.08778,594.1589,609.14608,289.07173,301.03535,435.12964,447.09326,447.09326,463.08817,471.3479,577.1351,577.1351,593.1511,623.1617,133.01422,179.056,191.05608,289.07173],[10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10],[150,112,112,112,159,163,217,2.249,2.271,166,147,210,3.2,183,3.058,169,373,2.572,2.34,2.946,2.984,30,0.319,0.34,135],[148,110,110,109,157,161,214,2.189,2.211,162,144,207,3.14,179,2.998,163,371,2.512,2.28,2.886,2.924,18,0.259,0.28,132],[154,117,116,117,163,165,221,2.309,2.331,169,151,214,3.26,186,3.118,175,376,2.632,2.4,3.006,3.044,36,0.379,0.4,140],[\"s\",\"s\",\"s\",\"s\",\"s\",\"s\",\"s\",\"min\",\"min\",\"s\",\"s\",\"s\",\"min\",\"s\",\"min\",\"s\",\"s\",\"min\",\"min\",\"min\",\"min\",\"s\",\"min\",\"min\",\"s\"],[1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th> <\\/th>\\n      <th>peak_label<\\/th>\\n      <th>mz_mean<\\/th>\\n      <th>mz_width<\\/th>\\n      <th>rt<\\/th>\\n      <th>rt_min<\\/th>\\n      <th>rt_max<\\/th>\\n      <th>rt_unit<\\/th>\\n      <th>intensity_threshold<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"columnDefs\":[{\"className\":\"dt-right\",\"targets\":[2,3,4,5,6,8]},{\"orderable\":false,\"targets\":0},{\"name\":\" \",\"targets\":0},{\"name\":\"peak_label\",\"targets\":1},{\"name\":\"mz_mean\",\"targets\":2},{\"name\":\"mz_width\",\"targets\":3},{\"name\":\"rt\",\"targets\":4},{\"name\":\"rt_min\",\"targets\":5},{\"name\":\"rt_max\",\"targets\":6},{\"name\":\"rt_unit\",\"targets\":7},{\"name\":\"intensity_threshold\",\"targets\":8}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\n### Running targeted extraction\n\n\n```python\nmint.run(fn = 'Results/Pos/raw_integration.csv')\n<ms_mint.Mint.Mint at 0x109083610>\n```\n\n```python\nmint.plot.peak_shapes(col_wrap=3)\n```\n\n![](peaks_QC_pos.png)\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../../site_libs/htmlwidgets-1.6.4/htmlwidgets.js\"></script>\n<link href=\"../../site_libs/datatables-css-0.0.0/datatables-crosstalk.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/datatables-binding-0.31/datatables.js\"></script>\n<script src=\"../../site_libs/jquery-3.6.0/jquery-3.6.0.min.js\"></script>\n<link href=\"../../site_libs/dt-core-1.13.6/css/jquery.dataTables.min.css\" rel=\"stylesheet\" />\n<link href=\"../../site_libs/dt-core-1.13.6/css/jquery.dataTables.extra.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/dt-core-1.13.6/js/jquery.dataTables.min.js\"></script>\n<link href=\"../../site_libs/crosstalk-1.2.1/css/crosstalk.min.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/crosstalk-1.2.1/js/crosstalk.min.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}